[supervisord]
nodaemon=true
user=root
logfile=/var/log/supervisor/supervisord.log
pidfile=/var/run/supervisord.pid

[program:xvfb]
command=Xvfb :99 -screen 0 1920x1080x24 -ac
user=angrav
autorestart=true
priority=10
stdout_logfile=/var/log/supervisor/xvfb.log
stderr_logfile=/var/log/supervisor/xvfb-error.log

[program:dbus]
command=dbus-daemon --session --nofork --nopidfile
user=angrav
environment=DISPLAY=":99"
autorestart=true
priority=15
stdout_logfile=/var/log/supervisor/dbus.log
stderr_logfile=/var/log/supervisor/dbus-error.log

[program:fluxbox]
command=fluxbox
user=angrav
environment=DISPLAY=":99"
autorestart=true
priority=20
startsecs=3
stdout_logfile=/var/log/supervisor/fluxbox.log
stderr_logfile=/var/log/supervisor/fluxbox-error.log

[program:vnc]
command=x11vnc -display :99 -forever -shared -rfbport 5900 -bg -o /var/log/supervisor/x11vnc.log
user=angrav
autorestart=true
priority=25
stdout_logfile=/var/log/supervisor/vnc.log
stderr_logfile=/var/log/supervisor/vnc-error.log

[program:windsurf]
command=windsurf --remote-debugging-port=9222 --no-sandbox /workspace/project
user=angrav
directory=/workspace
environment=DISPLAY=":99",HOME="/home/angrav"
autorestart=true
priority=30
startsecs=5
stopwaitsecs=10
stdout_logfile=/var/log/supervisor/windsurf.log
stderr_logfile=/var/log/supervisor/windsurf-error.log

[program:angrav-worker]
command=npx ts-node /opt/angrav/worker.ts
user=angrav
directory=/opt/angrav
environment=DISPLAY=":99",HOME="/home/angrav"
autorestart=true
priority=40
startsecs=15
startretries=5
stdout_logfile=/var/log/supervisor/angrav.log
stderr_logfile=/var/log/supervisor/angrav-error.log
